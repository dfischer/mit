#!/usr/bin/env python3
# Dump Mit object file as hex and disassembly
# (c) Mit authors 2018-2019
# This file is in the public domain.

import sys
import os

import mit@PACKAGE_SUFFIX@

if len(sys.argv) != 2:
    print("Usage: mit-dump OBJECT-FILE")
    sys.exit(1)
file = sys.argv[1]
base, ext = os.path.splitext(file)

VM = mit.State()
length = VM.load(file)

with open("{}.asm".format(file), "w") as h:
    VM.disassemble(0, length, file=h)
with open("{}.hex".format(file), "w") as h:
    VM.dump(0, length, file=h)
