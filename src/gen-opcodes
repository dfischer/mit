#!/usr/bin/env python3
# Generate instructions opcode list.
#
# (c) Mit authors 2018-2019
#
# The package is distributed under the MIT/X11 License.
#
# THIS PROGRAM IS PROVIDED AS IS, WITH NO WARRANTY. USE IS AT THE USERâ€™S
# RISK.

from mit_core.vm_data import (
    Instruction, InternalExtraInstruction,
    ExecutionError,
)
from mit_core.errors import MallocError, LoadError, SaveError


def print_enum(enum, prefix):
    print('enum {')
    for error in enum:
        print('    {}{} = {},'.format(prefix, error.name, error))
    print('};\n')


print('''\
// Auto-generated by gen-opcodes - DO NOT EDIT.
//
// Instruction opcodes.

#ifndef MIT_OPCODES
#define MIT_OPCODES


#define INSTRUCTION(name, opcode) name = opcode,
''')

Instruction.print_c('O_')
InternalExtraInstruction.print_c('O_EXTRA_')

print('''
#undef INSTRUCTION
''')

print_enum(ExecutionError, 'MIT_ERROR_')
print_enum(MallocError, 'MIT_MALLOC_ERROR_')
print_enum(LoadError, 'MIT_LOAD_ERROR_')
print_enum(SaveError, 'MIT_SAVE_ERROR_')

print('#endif')
