#!/usr/bin/env python3
# Calculate type sizes for extra instructions.
#
# (c) Mit authors 2019
#
# The package is distributed under the MIT/X11 License.
#
# THIS PROGRAM IS PROVIDED AS IS, WITH NO WARRANTY. USE IS AT THE USERâ€™S
# RISK.

import re

from extra_instructions import LibInstruction

print('''\
# Auto-generated by gen-type-sizes - DO NOT EDIT.
AC_INIT([type-sizes], [0.1])
ac_includes_default="\\
#include \\"config.h\\"
{}"
'''.format(re.sub('"', '\\"',
                  '\n'.join([lib.includes for lib in LibInstruction]))))

for type in list(set(['mit_word'] +
                     [type for lib in LibInstruction
                      for type in lib.types()])):
    print('AC_CHECK_SIZEOF([{}])'.format(type))

# We don't need this header, but autoconf insists we define it.
print('AC_CONFIG_HEADERS([type-sizes.h])')
